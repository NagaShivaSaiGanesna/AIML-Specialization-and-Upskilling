# Dynamic URLs and the Jinja2 Template Engine

In this session, we transition from simple static routing to building **dynamic, data-driven web applications**. We will explore how to pass data between Python and HTML, how to use logical structures within your templates, and how to build URLs programmatically.

---

## 1. Variable Rules: Capturing URL Parameters

A **Variable Rule** allows you to capture a segment of a URL and pass it as an argument to your view function. This is essential for creating user-specific or data-specific pages.

### Syntax and Data Types

You can specify a converter to ensure the data type is correct before it reaches your function:

* `<int:variable_name>`: Only accepts integers.
* `<float:variable_name>`: Accepts floating-point numbers.
* `<string:variable_name>`: (Default) Accepts any text without a slash.

**Example Implementation:**

```python
@app.route("/success/<int:score>")
def success(score):
    return f"The marks you got is {score}"

```

---

## 2. Jinja2 Template Engine

**Jinja2** is a powerful engine that allows you to embed Python-like logic directly into your HTML. It uses specific delimiters to distinguish between static text and dynamic logic.

### Delimiter Types

| Delimiter | Purpose | Example |
| --- | --- | --- |
| `{{ ... }}` | **Expressions** to print output to the template. | `{{ results.score }}` |
| `{% ... %}` | **Statements** for logic like loops and conditionals. | `{% if score > 50 %}` |
| `{# ... #}` | **Comments** not visible in the rendered HTML. | `{# This is a note #}` |

### Using Conditionals and Loops

You can perform logic directly inside your `.html` files:

**Conditional Example (`result.html`):**

```html
{% if results >= 50 %}
    <h1>Status: Passed</h1>
{% else %}
    <h1>Status: Failed</h1>
{% endblock %}

```

**Looping Example (`result_table.html`):**

```html
<table>
    {% for key, value in results.items() %}
    <tr>
        <th>{{ key }}</th>
        <td>{{ value }}</td>
    </tr>
    {% endfor %}
</table>

```

*Note: Always remember to close blocks with `{% endif %}` or `{% endfor %}`.*

---

## 3. Building Dynamic URLs with `url_for`

In a professional application, you should never hardcode URLs (e.g., `<a href="/success/50">`). If you change your route structure later, hardcoded links will break. Instead, use the `url_for()` function.

### How `url_for` Works

1. It takes the **name of the function** (not the route path) as its first argument.
2. It accepts keyword arguments for any variable parts of the URL.

### Redirecting with `redirect()`

Often, after processing a form, you want to send the user to a new page.

```python
from flask import redirect, url_for

@app.route("/submit", methods=["POST"])
def submit():
    total_score = calculate_marks() # Logic to get marks
    if total_score >= 50:
        # Redirects to the function named 'success' with the parameter score
        return redirect(url_for("success", score=total_score))
    else:
        return redirect(url_for("fail", score=total_score))

```

---

## 4. Practical Implementation: Multi-Subject Result App

By combining these concepts, we can build a workflow where:

1. **Form Input:** A user enters marks for Science, Math, and Data Science in a form.
2. **Calculation:** Flask captures these via `request.form`, typecasts them to `float`, and calculates an average.
3. **Dynamic Routing:** Flask uses `url_for` to determine if the user should see a "Success" or "Failure" page.
4. **Template Injection:** Jinja2 displays the final calculated dictionary (Score, Result, etc.) in a clean HTML table.

### Technical Correction on Form Actions

In your HTML `<form>` tag, the `action` attribute determines where the data is sent.

* Using `action="{{ url_for('submit') }}"` ensures that your form always points to the correct backend function, even if you change the URL path in your Python code.

---

## Summary Checklist

* [ ] Use **Variable Rules** to capture data directly from the URL.
* [ ] Use **Jinja2 `{{ }}**` to display variables and **`{% %}`** for logic.
* [ ] Use **`url_for()`** to generate URLs dynamically to prevent broken links.
* [ ] Use **`redirect()`** to guide users to different routes based on logic.

